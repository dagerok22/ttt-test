{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/logger.js","webpack:///external \"mongoose\"","webpack:///external \"express\"","webpack:///./src/server.js","webpack:///external \"lodash\"","webpack:///external \"body-parser\"","webpack:///external \"path\"","webpack:///./src/model/Statistics.js","webpack:///./src/routes/game.js","webpack:///./src/model/Game.js","webpack:///./src/routes/index.js","webpack:///external \"bunyan\"","webpack:///external \"cookie-parser\"","webpack:///external \"morgan\"","webpack:///./src/app.js","webpack:///external \"socket.io\"","webpack:///./src/config.js","webpack:///./src/db/connection.js","webpack:///external \"http\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","w","s","logger","a","createLogger","require","http","Server","_app__WEBPACK_IMPORTED_MODULE_1__","io","socket_io__WEBPACK_IMPORTED_MODULE_0___default","listen","process","env","PORT","_logger__WEBPACK_IMPORTED_MODULE_2__","warn","port","Statistics_moveSchema","external_mongoose_default","Schema","row","Number","column","player","Statistics_gameSchema","winner","type","required","moves","default","toJSON","virtuals","toObject","virtual","this","Statistics_statisticsSchema","user","String","games","date","Date","now","toLocaleDateString","set","getTime","Statistics","model","game_router","external_express_default","Router","_ref2","req","res","server","on","socket","info","game","constructor","indexOfPlayerToTurnFirst","_field","_indexOfPlayerToTurn","_turns","_winner","_games","getTurns","getState","field","getStats","stats","map","gameStat","turns","push","retry","playerTurn","isOver","makeTurnForPlayer","availableCells","cell","filter","undefined","reduce","b","concat","console","log","Math","round","random","length","isWinning","external_lodash_default","flatten","e","board","emit","game_asyncToGenerator","handshake","address","save","_id","cords","result","render","next","Types","ObjectId","isValid","params","statsId","json","error","message","findById","status","_x","_x2","_x3","apply","arguments","routes_game","routes_router","use","__webpack_exports__","app","express__WEBPACK_IMPORTED_MODULE_0___default","path__WEBPACK_IMPORTED_MODULE_1___default","join","__dirname","morgan__WEBPACK_IMPORTED_MODULE_2___default","body_parser__WEBPACK_IMPORTED_MODULE_4___default","urlencoded","extended","cookie_parser__WEBPACK_IMPORTED_MODULE_3___default","static","_routes_index__WEBPACK_IMPORTED_MODULE_6__","err","Error","locals","config","connectionAddress","Promise","global","connect"],"mappings":"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","file":"backend.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading wasm modules\n \tvar installedWasmModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// object with all compiled WebAssembly.Modules\n \t__webpack_require__.w = {};\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","import bunyan from \"bunyan\";\n\nconst logger = bunyan.createLogger({name: 'ttt-game-test'});\n\nexport {logger};","module.exports = require(\"mongoose\");","module.exports = require(\"express\");","import socketIO from 'socket.io';\nimport app from './app';\nimport {logger} from './logger';\n\nconst http = require('http').Server(app);\nconst io = socketIO(http);\n\nhttp.listen(process.env.PORT || 3000, () => {\n    logger.warn(`Listening on port ${process.env.port || 3000}`);\n});\n\nexport {io, http};\n","module.exports = require(\"lodash\");","module.exports = require(\"body-parser\");","module.exports = require(\"path\");","import mongoose from 'mongoose';\n\nconst moveSchema = new mongoose.Schema({\n    row: Number,\n    column: Number,\n    player: Number,\n});\n\nconst gameSchema = new mongoose.Schema({\n    winner: {\n        type: Number,\n        required: true,\n    },\n    moves: {\n        type: [moveSchema],\n        default: [],\n    },\n}, {\n    toJSON: {\n        virtuals: true,\n    },\n    toObject: {\n        virtuals: true,\n    },\n});\n\ngameSchema.virtual('formattedWinner').get(function() {\n    return this.winner === 1 ? 'You won' : this.winner === 2 ? 'You lost' : 'Draw';\n});\n\nconst statisticsSchema = new mongoose.Schema({\n    user: {\n        type: String,\n    },\n    games: {\n        type: [gameSchema],\n        required: true,\n        default: [],\n    },\n    date: {\n        type: Number,\n        required: true,\n        default: Date.now(),\n        get: (date) => new Date(date).toLocaleDateString(),\n        set: (date) => date.getTime(),\n    },\n});\n\nexport default mongoose.model('Statistic', statisticsSchema);\n","import mongoose from 'mongoose';\nimport express from 'express';\nimport {io} from '../server';\nimport {Game} from '../model/Game';\nimport Statistics from '../model/Statistics';\nimport {logger} from '../logger';\n\nconst router = express.Router();\n\nrouter.get('/', (req, res) => {\n  io.on('connection', (socket) => {\n    logger.info('Connected');\n    const game = new Game(1);\n    socket.emit('connection-status', 'connected');\n    socket.emit('update-field', game.getState());\n\n    socket.on('save-stats', async ()=>{\n        const stats = new Statistics();\n        stats.user = socket.handshake.address.address;\n        logger.info('saving with user ', stats.user);\n        logger.info('socket handshake address ', socket.handshake.address);\n        stats.games = game.getStats();\n        await stats.save();\n        logger.info('stats saved', stats);\n        socket.emit('stats-saved', stats._id);\n    });\n\n    socket.on('player-turn', (cords) => {\n      let result = game.playerTurn(cords, 1);\n      socket.emit('update-field', result);\n    });\n\n    socket.on('retry', () => {\n      let result = game.retry(1);\n      socket.emit('update-field-retry', result);\n    });\n    socket.on('disconnect', () => {\n      logger.info('Disconnected');\n      socket.emit('connection-status', 'Disconnected');\n    });\n  });\n  return res.render('game');\n});\n\nrouter.get('/statistics/:statsId', async (req, res, next)=>{\n    if (!mongoose.Types.ObjectId.isValid(req.params.statsId)) {\n        return res.json({error: 1, message: 'Invalid ID'});\n    }\n\n    const stats = await Statistics.findById(req.params.statsId);\n    if (!stats) {\n        res.status = 404;\n        return next();\n    }\n\n    return res.render('stats', stats.toJSON());\n});\n\nexport default router;\n","import _ from 'lodash';\nimport {logger} from '../logger';\n\n\nclass Game {\n    constructor(indexOfPlayerToTurnFirst) {\n        this._field = [\n            [0, 0, 0],\n            [0, 0, 0],\n            [0, 0, 0],\n        ];\n        this._indexOfPlayerToTurn = indexOfPlayerToTurnFirst;\n        this._turns = [];\n        this._winner = 0;\n        this._games = [];\n    }\n\n    getTurns() {\n        return this._turns;\n    };\n\n    getState() {\n        return {\n            field: this._field,\n            winner: this._winner,\n        };\n    };\n\n    getStats() {\n        const stats = this._games.map((gameStat) => {\n            let gameObj = {\n                winner: gameStat.winner,\n                moves: gameStat.turns,\n            };\n            return gameObj;\n        });\n        logger.info(this);\n        if (this._winner) {\n            stats.push({winner: this._winner, moves: this._turns});\n        }\n        return stats;\n    }\n\n    retry(indexOfPlayerToTurnFirst) {\n        if (this._winner) {\n            this._games.push({\n                turns: this._turns,\n                winner: this._winner,\n            });\n        }\n        this._field = [\n            [0, 0, 0],\n            [0, 0, 0],\n            [0, 0, 0],\n        ];\n        this._indexOfPlayerToTurn = indexOfPlayerToTurnFirst;\n        this._turns = [];\n        this._winner = 0;\n        return this.getState();\n    }\n\n    playerTurn({\n        row,\n        column,\n    }, player) {\n        if (!row || !column || this._indexOfPlayerToTurn !== player || this._field[+row][+column] !== 0) {\n            return;\n        }\n        this._field[row][column] = player;\n        this._turns.push({\n            row,\n            column,\n            player,\n        });\n        this._indexOfPlayerToTurn = player === 1 ? 2 : 1;\n        let winner = this.isOver();\n        if (winner === 0) {\n            this.makeTurnForPlayer(player === 1 ? 2 : 1);\n            winner = this.isOver();\n        }\n        this._winner = winner;\n        return this.getState();\n    }\n\n    makeTurnForPlayer(player) {\n        if (this._indexOfPlayerToTurn !== player) {\n            return;\n        }\n\n        let availableCells = this._field.map((row, i) => {\n            let available = row.map((cell, i) => {\n                if (cell === 0) {\n                    return i;\n                }\n            });\n            return available.map((cell) => [i, cell]).filter((a) => a[0] !== undefined && a[1] !== undefined);\n        }).reduce((a, b) => a.concat(b), []);\n\n        console.log(availableCells);\n        let cell = availableCells[Math.round(Math.random() * (availableCells.length - 1))];\n        this._field[cell[0]][cell[1]] = player;\n        this._turns.push({\n            row: cell[0],\n            column: cell[1],\n            player,\n        });\n        this._indexOfPlayerToTurn = player === 2 ? 1 : 2;\n    }\n\n    isOver() {\n        if (this.isWinning(1)) {\n            return 1;\n        }\n        if (this.isWinning(2)) {\n            return 2;\n        }\n\n        const emptyCells = _.flatten(this._field).reduce((a, e) => e === 0 ? a + 1 : a, 0);\n        if (!emptyCells) {\n            return -1;\n        }\n\n        return 0;\n    }\n\n    isWinning(player) {\n        const board = _.flatten(this._field);\n        return (board[0] === player && board[1] === player && board[2] === player) ||\n            (board[3] === player && board[4] === player && board[5] === player) ||\n            (board[6] === player && board[7] === player && board[8] === player) ||\n            (board[0] === player && board[3] === player && board[6] === player) ||\n            (board[1] === player && board[4] === player && board[7] === player) ||\n            (board[2] === player && board[5] === player && board[8] === player) ||\n            (board[0] === player && board[4] === player && board[8] === player) ||\n            (board[2] === player && board[4] === player && board[6] === player);\n    }\n}\n\nexport {\n    Game,\n};\n","import express from 'express';\nimport game from './game';\n\nconst router = express.Router();\n\nrouter.get('/', (req, res) => res.render('index'));\n\nrouter.use('/game', game);\n\nexport default router;\n","module.exports = require(\"bunyan\");","module.exports = require(\"cookie-parser\");","module.exports = require(\"morgan\");","import express from 'express';\nimport path from 'path';\nimport morgan from 'morgan';\nimport cookieParser from 'cookie-parser';\nimport bodyParser from 'body-parser';\n\nimport './db/connection';\nimport index from './routes/index';\n\nconst app = express();\n\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'hbs');\n\napp.use(morgan('dev'));\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({\n  extended: false,\n}));\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, 'public')));\n\napp.use('/', index);\n\napp.use(function(req, res, next) {\n  const err = new Error('Not Found');\n  err.status = 404;\n  next(err);\n});\n\napp.use(function(err, req, res) {\n  res.locals.message = err.message;\n  res.locals.error = req.app.get('env') === 'development' ? err : {};\n\n  res.status(err.status || 500);\n  res.render('error');\n});\n\nexport default app;\n","module.exports = require(\"socket.io\");","export default {\n    connectionAddress: `mongodb://cnxo138mx18:mIaudm9asud9SAUdamusd@test-shard-00-00-b4nqr.mongodb.net:27017,test-shard-00-01-b4nqr.mongodb.net:27017,test-shard-00-02-b4nqr.mongodb.net:27017/test?ssl=true&replicaSet=Test-shard-0&authSource=admin`,\n}\n","import mongoose from 'mongoose';\nimport config from '../config';\n\n\nmongoose.Promise = global.Promise;\ntry {\n    mongoose.connect(config.connectionAddress);\n} catch (error) {\n    console.log(error);\n}\n","module.exports = require(\"http\");"],"sourceRoot":""}